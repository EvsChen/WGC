!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=1)}([,function(e,t){const n=io(),o=document.createElement("div");if(o.id="qr",document.body.appendChild(o),window.location.href.indexOf("?id=")>0){console.log(`Hey, you're a controller trying to connect to: ${window.location.href.split("?id=")[1]}`),n.emit("controller_connect",window.location.href.split("?id=")[1]);const e={accelerate:!1,steer:0},t=()=>{n.emit("controller_state_change",e)},o=n=>{n.preventDefault(),console.log("mouse down"),e.accelerate=!0,t()},r=n=>{n.preventDefault(),e.accelerate=!1,t()},s=n=>{e.steer=n.accelerationIncludingGravity.y/100,t()};document.body.addEventListener("touchstart",o,!1),document.body.addEventListener("MSPointerDown",o,!1),document.body.addEventListener("touchend",r,!1),document.body.addEventListener("MSPointerUp",r,!1),window.addEventListener("devicemotion",s,!1),window.addEventListener("mousedown",o,!1),window.addEventListener("mouseup",r,!1)}else{class e{constructor(e,t){this.x=e,this.y=t,this.accelerate=!1,this.speed=0,this.steer=0;const n=document.createElement("div");n.id="carId",n.style.width="100px",n.style.height="100px",n.style.position="absolute",n.style.left=`${e}px`,n.style.top=`${t}px`,n.style.backgroundColor="red",document.body.appendChild(n),this.elem=document.getElementById("carId"),this.refreshInterval=window.setInterval(this.refreshState.bind(this),100)}setState(e){this.accelerate=e.accelerate,this.steer=e.steer,this.refreshState()}refreshState(){this.accelerate?this.speed<20&&(this.speed+=3):this.speed>0&&(this.speed-=3),this.x+=this.speed,this.setPositon()}setPositon(){this.elem.style.left=`${this.x}px`,this.elem.style.top=`${this.y}px`}destroy(){document.body.removeChild(this.elem),window.clearInterval(this.refreshInterval)}}n.emit("game_connect");const t=()=>{const e=`http://localhost:3000?id=${n.id}`;document.body.innerHTML+=e,new QRCode("qr").makeCode(e),n.removeListener("game_connected",t)},o=t=>{if(t){console.log("Controller connected successfully"),document.getElementById("qr").style.display="none";const t=new e(100,100);n.on("controller_state_change",e=>{t.setState(e)}),n.on("controller_disconnected",()=>{t.destroy()})}else console.log("Controller failed to connect"),document.getElementById("qr").style.display="block"};n.on("game_connected",t),n.on("controller_connected",o)}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL2luZGV4LmpzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJjb25maWd1cmFibGUiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsInZhbHVlIiwibiIsIl9fZXNNb2R1bGUiLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJzb2NrZXQiLCJpbyIsInFyIiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50IiwiaWQiLCJib2R5IiwiYXBwZW5kQ2hpbGQiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsImhyZWYiLCJpbmRleE9mIiwiY29uc29sZSIsImxvZyIsInNwbGl0IiwiZW1pdCIsImNvbnRyb2xsZXJTdGF0ZSIsImFjY2VsZXJhdGUiLCJzdGVlciIsImVtaXRVcGRhdGVzIiwidG91Y2hzdGFydCIsImUiLCJwcmV2ZW50RGVmYXVsdCIsInRvdWNoZW5kIiwiZGV2aWNlbW90aW9uIiwiYWNjZWxlcmF0aW9uSW5jbHVkaW5nR3Jhdml0eSIsInkiLCJhZGRFdmVudExpc3RlbmVyIiwiQ2FyIiwiW29iamVjdCBPYmplY3RdIiwieCIsInRoaXMiLCJzcGVlZCIsImNhckRpdiIsInN0eWxlIiwid2lkdGgiLCJoZWlnaHQiLCJwb3NpdGlvbiIsImxlZnQiLCJ0b3AiLCJiYWNrZ3JvdW5kQ29sb3IiLCJlbGVtIiwiZ2V0RWxlbWVudEJ5SWQiLCJyZWZyZXNoSW50ZXJ2YWwiLCJzZXRJbnRlcnZhbCIsInJlZnJlc2hTdGF0ZSIsImJpbmQiLCJzdGF0ZSIsInNldFBvc2l0b24iLCJyZW1vdmVDaGlsZCIsImNsZWFySW50ZXJ2YWwiLCJnYW1lQ29ubmVjdGVkTGlzdGVuZXIiLCJ1cmwiLCJpbm5lckhUTUwiLCJRUkNvZGUiLCJtYWtlQ29kZSIsInJlbW92ZUxpc3RlbmVyIiwiY29udHJvbGxlckNvbm5lY3RlZExpc3RlbmVyIiwiaXNDb25uZWN0ZWQiLCJkaXNwbGF5IiwiY2FyIiwib24iLCJzZXRTdGF0ZSIsImRlc3Ryb3kiXSwibWFwcGluZ3MiOiJhQUNBLElBQUFBLEtBR0EsU0FBQUMsRUFBQUMsR0FHQSxHQUFBRixFQUFBRSxHQUNBLE9BQUFGLEVBQUFFLEdBQUFDLFFBR0EsSUFBQUMsRUFBQUosRUFBQUUsSUFDQUcsRUFBQUgsRUFDQUksR0FBQSxFQUNBSCxZQVVBLE9BTkFJLEVBQUFMLEdBQUFNLEtBQUFKLEVBQUFELFFBQUFDLElBQUFELFFBQUFGLEdBR0FHLEVBQUFFLEdBQUEsRUFHQUYsRUFBQUQsUUFLQUYsRUFBQVEsRUFBQUYsRUFHQU4sRUFBQVMsRUFBQVYsRUFHQUMsRUFBQVUsRUFBQSxTQUFBUixFQUFBUyxFQUFBQyxHQUNBWixFQUFBYSxFQUFBWCxFQUFBUyxJQUNBRyxPQUFBQyxlQUFBYixFQUFBUyxHQUNBSyxjQUFBLEVBQ0FDLFlBQUEsRUFDQUMsSUFBQU4sS0FNQVosRUFBQW1CLEVBQUEsU0FBQWpCLEdBQ0FZLE9BQUFDLGVBQUFiLEVBQUEsY0FBaURrQixPQUFBLEtBSWpEcEIsRUFBQXFCLEVBQUEsU0FBQWxCLEdBQ0EsSUFBQVMsRUFBQVQsS0FBQW1CLFdBQ0EsV0FBMkIsT0FBQW5CLEVBQUEsU0FDM0IsV0FBaUMsT0FBQUEsR0FFakMsT0FEQUgsRUFBQVUsRUFBQUUsRUFBQSxJQUFBQSxHQUNBQSxHQUlBWixFQUFBYSxFQUFBLFNBQUFVLEVBQUFDLEdBQXNELE9BQUFWLE9BQUFXLFVBQUFDLGVBQUFuQixLQUFBZ0IsRUFBQUMsSUFHdER4QixFQUFBMkIsRUFBQSxJQUlBM0IsSUFBQTRCLEVBQUEsb0JDOURBLE1BQUFDLEVBQUFDLEtBSUFDLEVBQUFDLFNBQUFDLGNB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RCxFQUFBNkQsR0FBQSxpQkFBQVYsR0FDQW5ELEVBQUE2RCxHQUFBLHVCQUFBSiIsImZpbGUiOiJhcHAuYnVuZGxlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7XG4gXHRcdFx0XHRjb25maWd1cmFibGU6IGZhbHNlLFxuIFx0XHRcdFx0ZW51bWVyYWJsZTogdHJ1ZSxcbiBcdFx0XHRcdGdldDogZ2V0dGVyXG4gXHRcdFx0fSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiL1wiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMSk7XG4iLCIvKipcbiAqIEBmaWxlOiBpbmRleC5qc1xuICogQGF1dGhvcjogRXZzQ2hlblxuICoqL1xuXG5jb25zdCBzb2NrZXQgPSBpbygpO1xuY29uc3QgR0FNRV9DT05ORUNUID0gJ2dhbWVfY29ubmVjdCc7XG5jb25zdCBHQU1FX0NPTk5FQ1RFRCA9ICdnYW1lX2Nvbm5lY3RlZCc7XG5jb25zdCBDT05UUk9MTEVSX1NUQVRFX0NIQU5HRSA9ICdjb250cm9sbGVyX3N0YXRlX2NoYW5nZSc7XG5jb25zdCBxciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xucXIuaWQgPSAncXInO1xuZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChxcik7XG5pZiAod2luZG93LmxvY2F0aW9uLmhyZWYuaW5kZXhPZignP2lkPScpID4gMCkge1xuICAgIGNvbnNvbGUubG9nKGBIZXksIHlvdSdyZSBhIGNvbnRyb2xsZXIgdHJ5aW5nIHRvIGNvbm5lY3QgdG86ICR7d2luZG93LmxvY2F0aW9uLmhyZWYuc3BsaXQoJz9pZD0nKVsxXX1gKTtcbiAgICBzb2NrZXQuZW1pdCgnY29udHJvbGxlcl9jb25uZWN0Jywgd2luZG93LmxvY2F0aW9uLmhyZWYuc3BsaXQoJz9pZD0nKVsxXSk7XG4gICAgY29uc3QgY29udHJvbGxlclN0YXRlID0ge1xuICAgICAgICBhY2NlbGVyYXRlOiBmYWxzZSxcbiAgICAgICAgc3RlZXI6IDBcbiAgICB9O1xuICAgIGNvbnN0IGVtaXRVcGRhdGVzID0gKCkgPT4ge1xuICAgICAgICBzb2NrZXQuZW1pdChDT05UUk9MTEVSX1NUQVRFX0NIQU5HRSwgY29udHJvbGxlclN0YXRlKTtcbiAgICB9O1xuICAgIGNvbnN0IHRvdWNoc3RhcnQgPSBlID0+IHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBjb25zb2xlLmxvZygnbW91c2UgZG93bicpO1xuICAgICAgICBjb250cm9sbGVyU3RhdGUuYWNjZWxlcmF0ZSA9IHRydWU7XG4gICAgICAgIGVtaXRVcGRhdGVzKCk7XG4gICAgfTtcbiAgICBjb25zdCB0b3VjaGVuZCA9IGUgPT4ge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGNvbnRyb2xsZXJTdGF0ZS5hY2NlbGVyYXRlID0gZmFsc2U7XG4gICAgICAgIGVtaXRVcGRhdGVzKCk7XG4gICAgfTtcbiAgICBjb25zdCBkZXZpY2Vtb3Rpb24gPSBlID0+IHtcbiAgICAgICAgY29udHJvbGxlclN0YXRlLnN0ZWVyID0gZS5hY2NlbGVyYXRpb25JbmNsdWRpbmdHcmF2aXR5LnkgLyAxMDA7XG4gICAgICAgIGVtaXRVcGRhdGVzKCk7XG4gICAgfTtcbiAgICBkb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCB0b3VjaHN0YXJ0LCBmYWxzZSk7IC8vIGlPUyAmIEFuZHJvaWRcbiAgICBkb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoJ01TUG9pbnRlckRvd24nLCB0b3VjaHN0YXJ0LCBmYWxzZSk7IC8vIFdpbmRvd3MgUGhvbmVcbiAgICBkb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgdG91Y2hlbmQsIGZhbHNlKTsgLy8gaU9TICYgQW5kcm9pZFxuICAgIGRvY3VtZW50LmJvZHkuYWRkRXZlbnRMaXN0ZW5lcignTVNQb2ludGVyVXAnLCB0b3VjaGVuZCwgZmFsc2UpOyAvLyBXaW5kb3dzIFBob25lXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2RldmljZW1vdGlvbicsIGRldmljZW1vdGlvbiwgZmFsc2UpO1xuXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHRvdWNoc3RhcnQsIGZhbHNlKTtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIHRvdWNoZW5kLCBmYWxzZSk7XG59XG5lbHNlIHtcbiAgICBjbGFzcyBDYXIge1xuICAgICAgICBjb25zdHJ1Y3Rvcih4LCB5KSB7XG4gICAgICAgICAgICB0aGlzLnggPSB4O1xuICAgICAgICAgICAgdGhpcy55ID0geTtcbiAgICAgICAgICAgIHRoaXMuYWNjZWxlcmF0ZSA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5zcGVlZCA9IDA7XG4gICAgICAgICAgICB0aGlzLnN0ZWVyID0gMDtcbiAgICAgICAgICAgIGNvbnN0IGNhckRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICAgICAgY2FyRGl2LmlkID0gJ2NhcklkJztcbiAgICAgICAgICAgIGNhckRpdi5zdHlsZS53aWR0aCA9ICcxMDBweCc7XG4gICAgICAgICAgICBjYXJEaXYuc3R5bGUuaGVpZ2h0ID0gJzEwMHB4JztcbiAgICAgICAgICAgIGNhckRpdi5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7XG4gICAgICAgICAgICBjYXJEaXYuc3R5bGUubGVmdCA9IGAke3h9cHhgO1xuICAgICAgICAgICAgY2FyRGl2LnN0eWxlLnRvcCA9IGAke3l9cHhgO1xuICAgICAgICAgICAgY2FyRGl2LnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICdyZWQnO1xuICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChjYXJEaXYpO1xuICAgICAgICAgICAgdGhpcy5lbGVtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NhcklkJyk7XG4gICAgICAgICAgICAvLyBLZXkgb2YgdGhlIHJlZnJlc2hcbiAgICAgICAgICAgIHRoaXMucmVmcmVzaEludGVydmFsID0gd2luZG93LnNldEludGVydmFsKHRoaXMucmVmcmVzaFN0YXRlLmJpbmQodGhpcyksIDEwMCk7XG4gICAgICAgIH1cblxuICAgICAgICBzZXRTdGF0ZShzdGF0ZSkge1xuICAgICAgICAgICAgdGhpcy5hY2NlbGVyYXRlID0gc3RhdGUuYWNjZWxlcmF0ZTtcbiAgICAgICAgICAgIHRoaXMuc3RlZXIgPSBzdGF0ZS5zdGVlcjtcbiAgICAgICAgICAgIHRoaXMucmVmcmVzaFN0YXRlKCk7XG4gICAgICAgIH1cblxuICAgICAgICByZWZyZXNoU3RhdGUoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5hY2NlbGVyYXRlKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc3BlZWQgPCAyMCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNwZWVkICs9IDM7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc3BlZWQgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3BlZWQgLT0gMztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnggKz0gdGhpcy5zcGVlZDtcbiAgICAgICAgICAgIHRoaXMuc2V0UG9zaXRvbigpO1xuICAgICAgICB9XG5cbiAgICAgICAgc2V0UG9zaXRvbigpIHtcbiAgICAgICAgICAgIHRoaXMuZWxlbS5zdHlsZS5sZWZ0ID0gYCR7dGhpcy54fXB4YDtcbiAgICAgICAgICAgIHRoaXMuZWxlbS5zdHlsZS50b3AgPSBgJHt0aGlzLnl9cHhgO1xuICAgICAgICB9XG5cbiAgICAgICAgZGVzdHJveSgpIHtcbiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQodGhpcy5lbGVtKTtcbiAgICAgICAgICAgIHdpbmRvdy5jbGVhckludGVydmFsKHRoaXMucmVmcmVzaEludGVydmFsKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzb2NrZXQuZW1pdCgnZ2FtZV9jb25uZWN0Jyk7XG4gICAgY29uc3QgZ2FtZUNvbm5lY3RlZExpc3RlbmVyID0gKCkgPT4ge1xuICAgICAgICAvLyBjb25zdCB1cmwgPSBgaHR0cDovLzE3Mi4yMC4xMC4xMDozMDAwP2lkPSR7c29ja2V0LmlkfWA7XG4gICAgICAgIGNvbnN0IHVybCA9IGBodHRwOi8vbG9jYWxob3N0OjMwMDA/aWQ9JHtzb2NrZXQuaWR9YDtcbiAgICAgICAgZG9jdW1lbnQuYm9keS5pbm5lckhUTUwgKz0gdXJsO1xuICAgICAgICBjb25zdCBxckNvZGUgPSBuZXcgUVJDb2RlKCdxcicpO1xuICAgICAgICBxckNvZGUubWFrZUNvZGUodXJsKTtcbiAgICAgICAgc29ja2V0LnJlbW92ZUxpc3RlbmVyKCdnYW1lX2Nvbm5lY3RlZCcsIGdhbWVDb25uZWN0ZWRMaXN0ZW5lcik7XG4gICAgfTtcbiAgICBjb25zdCBjb250cm9sbGVyQ29ubmVjdGVkTGlzdGVuZXIgPSBpc0Nvbm5lY3RlZCA9PiB7XG4gICAgICAgIGlmIChpc0Nvbm5lY3RlZCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ0NvbnRyb2xsZXIgY29ubmVjdGVkIHN1Y2Nlc3NmdWxseScpO1xuICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3FyJykuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICAgIGxldCBzcGVlZCA9IDA7XG4gICAgICAgICAgICBsZXQgY29udHJvbGxlclN0YXRlID0ge307XG4gICAgICAgICAgICBjb25zdCBjYXIgPSBuZXcgQ2FyKDEwMCwgMTAwKTtcbiAgICAgICAgICAgIHNvY2tldC5vbihDT05UUk9MTEVSX1NUQVRFX0NIQU5HRSwgc3RhdGUgPT4ge1xuICAgICAgICAgICAgICAgIGNhci5zZXRTdGF0ZShzdGF0ZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHNvY2tldC5vbignY29udHJvbGxlcl9kaXNjb25uZWN0ZWQnLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgY2FyLmRlc3Ryb3koKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ0NvbnRyb2xsZXIgZmFpbGVkIHRvIGNvbm5lY3QnKTtcbiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdxcicpLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBzb2NrZXQub24oJ2dhbWVfY29ubmVjdGVkJywgZ2FtZUNvbm5lY3RlZExpc3RlbmVyKTtcbiAgICBzb2NrZXQub24oJ2NvbnRyb2xsZXJfY29ubmVjdGVkJywgY29udHJvbGxlckNvbm5lY3RlZExpc3RlbmVyKTtcbn1cbiJdLCJzb3VyY2VSb290IjoiIn0=